<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>my imaginary dog - さんぽ</title>
<style>
  :root{
    --choco:#6e5647;
    --white:#fff;
    --shadow:0 10px 25px rgba(0,0,0,.08);
    --radius:16px;
  }
  /* ページ全体＆スマホ枠 */
  body{
    margin:0;
    min-height:100svh;
    display:grid; place-items:center;
    background:#f7f3ff;
    font-family:"Hiragino Sans","Noto Sans JP","Yu Gothic",system-ui,sans-serif;
    color:var(--choco);
  }
  .phone{
    width:min(420px,96vw);
    aspect-ratio:3/4;
    position:relative;
    border:4px solid #bda9ff;
    border-radius:24px;
    overflow:hidden;
    background:#fff;
    box-shadow:0 12px 40px rgba(0,0,0,.12);
  }

  /* 画面（PDF＋ボタン） */
  .screen{ position:absolute; inset:0; display:none; }
  .screen.active{ display:block; }

  /* PDFを全面に敷く */
  .bgwrap{ position:absolute; inset:0; z-index:0; }
  .bgdoc{
    width:100%; height:100%;
    border:0;
    pointer-events:none;
  }
  /* 画像を中央配置 */
  .bgwrap picture{
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .bgwrap img{
    width:50%;
    height:50%;
    object-fit:contain;
    /* ホーム画面の犬と同じ位置に調整 */
    transform:translateY(-25%);
  }

  /* 【さんぽ画面用CSS】散歩状態ごとの背景と画像の切り替え用コンテナ */
  .walk-state {
      position: absolute;
      inset: 0;
      opacity: 0; 
      transition: opacity 0.3s ease;
      z-index: 0;
  }
  .walk-state.active {
      opacity: 1; 
      z-index: 1; 
  }
  /* bgdocのスタイルを統一 */
  .bgwrap > .bgdoc, .walk-state > .bgdoc {
      width:100%; height:100%;
      border:0;
      pointer-events:none;
  }

  /* ボタン群（背景PDFの上） */
  .overlay{
    position:absolute; inset:0; z-index:1;
    display:flex; flex-direction:column;
    padding:14px;
  }

  /* 【さんぽ画面用CSS】散歩状態切り替えボタンのコンテナとボタンのスタイル */
  .walk-buttons-container {
      margin-top: auto; 
      margin-bottom: 20px; 
      display: flex;
      justify-content: center;
      width: 100%;
      height: 48px; /* ボタンの高さに合わせて調整 */
  }

  .walk-state-button {
      background: var(--white);
      border: 0; 
      border-radius: 14px;
      padding: 12px 16px;
      font-size: 20px; 
      letter-spacing: .35em;
      color: var(--choco);
      box-shadow: var(--shadow);
      cursor: pointer;
      transition: transform .05s ease, opacity 0.3s ease;
      
      /* 常に同じ位置に配置し、片方だけ表示 */
      position: absolute; 
      width: 80%; 
      max-width: 250px;
      
      opacity: 0;
      pointer-events: none; /* クリック不可に */
  }

  .walk-state-button.active {
      opacity: 1;
      pointer-events: auto; /* クリック可能に */
  }

  .walk-state-button:hover {
      background: #fff8e8;
      box-shadow: 0 8px 20px rgba(0,0,0,.15);
      transform: translateY(-2px);
  }
  .walk-state-button:active{
      background: #ffedc8;
      transform: translateY(1px) scale(.98);
      box-shadow: 0 3px 8px rgba(0,0,0,.1);
  }


  /* 子画面の左上「ホームへ」 */
  .home-icon{
    width:40px; height:40px;
    border-radius:12px;
    background:#fff; box-shadow:var(--shadow);
    display:grid; place-items:center;
    user-select:none; cursor:pointer;
    margin:6px;
    font-weight:700;
  }
  .home-icon:hover {
    background: #fff5e2;
    transform: translateY(-1px);
    box-shadow: 0 6px 12px rgba(0,0,0,.15);
  }
  .home-icon:active{
    transform:translateY(1px);
    box-shadow: 0 3px 6px rgba(0,0,0,.1);
  }

  /* 【さんぽ画面専用CSS】ホームアイコンの見た目を「◀」にする */
  .home-icon a::before {
    content: "🏠"; 
    font-size: 16px;
    display: block;
  }
  /* ホームアイコン内のaタグを中央配置 */
  .home-icon a {
    text-decoration: none;
    color: inherit;
    display: grid;
    place-items: center;
    width: 100%;
    height: 100%;
  }

  @media (prefers-reduced-motion: reduce){
    .walk-state-button,
    .home-icon{ transition:none; }
  }
</style>
</head>
<body>
<main class="phone" id="app">

  <section class="screen active" data-screen="walk" aria-label="さんぽ">
    <div class="bgwrap" aria-hidden="true">
      
      <div class="walk-state walk-before active">
        <object class="bgdoc" type="application/pdf"
                data="pdfs/walk-before.pdf#view=Fit&toolbar=0&navpanes=0&scrollbar=0">
          <picture><img src="images/walk.png" alt="" id="walkDogImageBefore"></picture>
        </object>
      </div>

      <div class="walk-state walk-after">
        <object class="bgdoc" type="application/pdf"
                data="pdfs/walk-after.pdf#view=Fit&toolbar=0&navpanes=0&scrollbar=0">
          <picture><img src="images/walk-after.png" alt="" id="walkDogImageAfter"></picture>
        </object>
      </div>
    </div>
    
    <div class="overlay">
      <div class="home-icon" aria-label="ホームへ">
        <a href="index.html"></a>
      </div>

      <div class="walk-buttons-container">
        <button class="walk-state-button walk-before-btn active" data-action="go-walk">さんぽにいく</button>
        <button class="walk-state-button walk-after-btn" data-action="go-home">かえる</button>
      </div>
    </div>
  </section>

</main>

<script>
  // 散歩画面の画像設定 (犬種によって散歩前後の画像を変える場合)
  // 必要に応じてファイルパスを修正してください。
  const walkDogImages = {
    sizu: {
      before: 'images/sizu.png', // 散歩前画像
      after: 'images/sizu.png'   // 散歩後画像
    },
    pome: {
      before: 'images/pome.png',
      after: 'images/pome.png'
    },
    shiba: {
      before: 'images/shiba.png',
      after: 'images/shiba.png'
    },
    hasuki: {
      before: 'images/hasuki.png',
      after: 'images/hasuki.png'
    },
    pagu: {
      before: 'images/pagu.png',
      after: 'images/pagu.png'
    },
    kogi: {
      before: 'images/kogi.png',
      after: 'images/kogi.png'
    },
  };


  // URLパラメータから犬を取得 (例: index_sanpo.html?dog=pome)
  const params = new URLSearchParams(window.location.search);
  const selectedDog = params.get('dog') || 'sizu';
  
  const app = document.getElementById('app');

  // 散歩画面の状態を切り替える関数
  function setWalkState(state) { // stateは 'before' または 'after'
    // 1. 背景と犬の画像を切り替え
    const dogImageElementId = (state === 'before') ? 'walkDogImageBefore' : 'walkDogImageAfter';
    const dogImageElement = document.getElementById(dogImageElementId);
    
    // 選択された犬種に応じた散歩中の画像をセット
    if(dogImageElement && walkDogImages[selectedDog]) {
      // 適切な画像パスをセット。未設定の場合はデフォルトパスを使用
      dogImageElement.src = walkDogImages[selectedDog][state] || dogImageElement.src; 
    }

    document.querySelectorAll('.walk-state').forEach(el => {
      el.classList.toggle('active', el.classList.contains(`walk-${state}`));
    });

    // 2. ボタンを切り替え
    document.querySelectorAll('.walk-state-button').forEach(btn => {
      btn.classList.toggle('active', btn.classList.contains(`walk-${state}-btn`));
    });
  }

  // アプリケーション起動時に「散歩前」の状態をセット
  window.addEventListener('load', () => {
    // 独立ページなので、初期状態を 'before' に設定
    setWalkState('before');
  });


// クリックイベントリスナー
app.addEventListener('click', e=>{
    // 散歩画面の状態切り替えボタン (data-action) の処理
    const walkBtn = e.target.closest('[data-action]');
    if (!walkBtn) return;
    
    const action = walkBtn.getAttribute('data-action');
    if (action === 'go-walk') {
        // 「さんぽにいく」ボタンが押された -> 散歩後状態へ
        setWalkState('after');
    } else if (action === 'go-home') {
        // 【変更後】「かえる」ボタンが押された -> 散歩前の状態へ戻る
        setWalkState('before');
    }
});


  // ホームアイコンの処理 (data-gotoの代わりに<a>タグを使用)
  const homeIcon = document.querySelector('.home-icon a');
  if (homeIcon) {
    // ホームアイコンがクリックされたら、犬種パラメータを付けて index.htmlへ遷移
    homeIcon.addEventListener('click', (e) => {
        e.preventDefault();
        window.location.href = `index.html?dog=${selectedDog}`;
    });
  }
</script>
</body>
</html>
